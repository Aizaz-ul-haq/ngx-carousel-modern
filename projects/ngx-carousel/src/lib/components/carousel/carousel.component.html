<div 
  class="carousel-container" 
  *ngIf="items.length > 0" 
  [ngClass]="containerClass"
  [ngStyle]="getMergedContainerStyles()"
  [class.snapping]="isSnapping"
  #carouselContainer
>
  <!-- Carousel Wrapper (matches JS version) -->
  <div 
    class="carousel-wrapper"
    #carouselWrapper
    [class.dragging]="getIsDragging()"
    (touchstart)="onDragStart($event)"
    (touchmove)="onDragMove($event)"
    (touchend)="onDragEnd($event)"
    (mousedown)="onDragStart($event)"
    (mousemove)="onDragMove($event)"
    (mouseup)="onDragEnd($event)"
    (mouseleave)="onDragEnd($event)"
  >
    <!-- Render all carousel items (original + clones) -->
    <div
      *ngFor="let item of carouselItems; let i = index"
      class="carousel-item"
      [class.active]="isItemActive(i)"
      [style.background-image]="'url(' + item.imageUrl + ')'"
      [style.background-color]="slideBackgroundColor"
      [ngStyle]="getSlideStyles()"
      [style.transform]="isItemActive(i) ? 'scale(' + activeSlideScale + ')' : 'scale(' + sideSlideScale + ')'"
      (click)="!getIsDragging() && !isAnimating && goToSlide(getOriginalIndex(i))"
    >
    </div>
  </div>

  <!-- Navigation Arrows -->
  <button
    type="button"
    class="nav-button prev-button"
    *ngIf="showArrows && items.length > 1"
    (click)="previousSlide(); $event.stopPropagation()"
    (mousedown)="$event.stopPropagation()"
    (touchstart)="$event.stopPropagation()"
    aria-label="Previous slide"
  >
    <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" aria-hidden="true" focusable="false">
      <rect width="56" height="56" rx="28" style="fill: var(--carousel-nav-bg, #E8F0FB)"/>
      <path d="M24.7611 37.0974C25.0145 37.0974 25.2678 37.0041 25.4678 36.8041C25.8545 36.4174 25.8545 35.7774 25.4678 35.3907L18.0811 28.0041L25.4678 20.6174C25.8545 20.2307 25.8545 19.5907 25.4678 19.2041C25.0811 18.8174 24.4411 18.8174 24.0545 19.2041L15.9611 27.2974C15.5745 27.6841 15.5745 28.3241 15.9611 28.7107L24.0545 36.8041C24.2545 37.0041 24.5078 37.0974 24.7611 37.0974Z" style="fill: var(--carousel-nav-color, #1967D2)"/>
      <path d="M16.8881 29L39.3281 29C39.8748 29 40.3281 28.5467 40.3281 28C40.3281 27.4533 39.8748 27 39.3281 27L16.8881 27C16.3415 27 15.8881 27.4533 15.8881 28C15.8881 28.5467 16.3415 29 16.8881 29Z" style="fill: var(--carousel-nav-color, #1967D2)"/>
    </svg>
  </button>
  
  <button
    type="button"
    class="nav-button next-button"
    *ngIf="showArrows && items.length > 1"
    (click)="nextSlide(); $event.stopPropagation()"
    (mousedown)="$event.stopPropagation()"
    (touchstart)="$event.stopPropagation()"
    aria-label="Next slide"
  >
    <svg class="nav-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 56 56" aria-hidden="true" focusable="false">
      <rect width="56" height="56" rx="28" style="fill: var(--carousel-nav-bg, #E8F0FB)"/>
      <path d="M31.2389 37.0974C30.9855 37.0974 30.7322 37.0041 30.5322 36.8041C30.1455 36.4174 30.1455 35.7774 30.5322 35.3907L37.9189 28.0041L30.5322 20.6174C30.1455 20.2307 30.1455 19.5907 30.5322 19.2041C30.9189 18.8174 31.5589 18.8174 31.9455 19.2041L40.0389 27.2974C40.4255 27.6841 40.4255 28.3241 40.0389 28.7107L31.9455 36.8041C31.7455 37.0041 31.4922 37.0974 31.2389 37.0974Z" style="fill: var(--carousel-nav-color, #1967D2)"/>
      <path d="M39.1119 29L16.6719 29C16.1252 29 15.6719 28.5467 15.6719 28C15.6719 27.4533 16.1252 27 16.6719 27L39.1119 27C39.6585 27 40.1119 27.4533 40.1119 28C40.1119 28.5467 39.6585 29 39.1119 29Z" style="fill: var(--carousel-nav-color, #1967D2)"/>
    </svg>
  </button>

  <!-- Dots Container -->
  <div class="dots-container" *ngIf="showDots && items.length > 1">
      <button
        type="button"
        *ngFor="let item of items; let i = index"
        class="dot"
        [class.active]="isActive(i)"
        (click)="goToSlide(i)"
        [attr.aria-label]="'Go to slide ' + (i + 1)"
        [attr.aria-current]="isActive(i) ? 'true' : null"
      ></button>
  </div>
</div>
